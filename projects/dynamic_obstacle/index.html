<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Dynamic Obstacles for Powered Wheelchair | Shail Dalal Portfolio</title> <meta name="author" content="Shail Dalal"> <meta name="description" content="Single actor system"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://sdalal1.github.io/projects/dynamic_obstacle/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Shail Dalal Portfolio</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Dynamic Obstacles for Powered Wheelchair</h1> <p class="post-description">Single actor system</p> </header> <article> <h2 id="project">Project:</h2> <h5 id="description"><strong>Description:</strong></h5> <p>       The objective of this project was to create dynamic obstacles for a Semi-autonomous wheelchair study. The wheelchair is equipped with a LUCI system which consists of an array of camera’s and sensors to enhance the capabilities of the wheelchair. The purpose of this project was to stress test the system by using robot robots as dynamic obstacles for the wheelchair to detect and record the reaction of the users and the system to these moving obstacles.</p> <p>There were two major milestones for the project:</p> <ol> <li>Single robot interaction</li> <li>Swarm system with 3 robot emulating a crowd</li> </ol> <h5 id="hardware-used"><strong>Hardware used:</strong></h5> <p><strong>First Hardware iteration:</strong> <br>        The Hardware used was a Mecanum wheel drive robot to emulate human like movement in both x-y directions. The hardware list included raspberry pi 4b as the controller, polulu motors and motor drivers and adafruit PWM board. The BOM is attached as an excel file here.</p> <div class="row mt-3"> <div class="col-sm mt-2 mt-md-0"> <style>.center-img{display:block;margin-left:auto;margin-right:auto}</style> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/car_v1-480.webp 480w,/assets/img/car_v1-800.webp 800w,/assets/img/car_v1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/car_v1.jpg" class="center-img" width="40%" height="auto" title="Raw terrain" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><strong>Machining HEX Mecanum Wheel Coupler</strong> <br>        The first version of the coupler were 3D printed which were not the most reliable, so decided to machine aluminum hex coupler from a square bar. This was done using a Mill and a CNC lathe.</p> <div class="row"> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/hex_1-480.webp 480w,/assets/img/hex_1-800.webp 800w,/assets/img/hex_1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/hex_1.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Raw terrain" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/hex_2-480.webp 480w,/assets/img/hex_2-800.webp 800w,/assets/img/hex_2-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/hex_2.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Multiple Actors Training" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </div> <p><strong>Second Hardware Iteration</strong> <br>        For the second iteration, a control board from Yahboom was used with a ROS2 controller in-built for mecanum wheel robot. The BOM is attached as the excel sheet.</p> <div class="row mt-3"> <div class="col-sm mt-2 mt-md-0"> <style>.center-img{display:block;margin-left:auto;margin-right:auto}</style> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/car_v2-480.webp 480w,/assets/img/car_v2-800.webp 800w,/assets/img/car_v2-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/car_v2.jpg" class="center-img" width="40%" height="auto" title="Raw terrain" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Both these iterations were used for the swarm system created.</p> <h5 id="software-created"><strong>Software Created:</strong></h5> <ol> <li> <strong>C++ driver for first iteration of hardware</strong> <ul> <li>Created a custom ROS2 and C++ driver for the first Iteration of the robot. The hardware wasn’t ROS supported so I created a c++ driver which can supply required PWM to the controller for the robot speed control. I used open source packages to be able to control the pins for the raspberry Pi (Wiringpi) and also a c++ package create for the PWM driver.</li> </ul> </li> <li> <strong>Kinematics Library for Mecanum Drive</strong> <ul> <li>Created a c++ kinematics library using Modern Robotics to control the robot using a commanded twist. This allows a smooth control of the robot in the desired direction and using the driver allows the speed control of the robot. The library provides Inverse Kinematics and Forward Kinematics provided the radius of the wheel and the length and and width of the robot.</li> </ul> </li> <li> <strong>ROS2 C++ package for robot control</strong> <ul> <li>Integrated the driver and the library to create a package to control the robot using a commanded twist. The twist can be published on the /cmd_vel topic which will be read by the robot.</li> <li>For the video here to test all the possible movements, I used the teleop_twist_keyboard to command a twist.</li> </ul> </li> </ol> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/All%20motions.mp4" class="img-fluid rounded z-depth-1" width="50%" height="auto" controls="" muted=""></video> </figure> </div> </div> <ol> <li> <strong>Joystick Control of the Robot</strong> <ul> <li>Used a PS4 controller and the ros2 joy_node to create a joystick control of the robot. This was done with the use of the controller already created.</li> </ul> </li> <li> <strong>Non Reactive Speed Control</strong> <ul> <li>Created a package to create a non reactive speed control of the robot. This was done as the first iteration of the obstacle where the robot was completely un-reactive to the environment. This was a more uncontrolled version where the robot would move in a straight line. Multiple services were created to perform different kinds of speed control.</li> <li>The 4 speed versions were as follows: <ul> <li>Slow Speed - The speed was set at 1000pwm, the slowest the robot could move.</li> <li>Fast Speed - The speed was set at 4095pwm, the fastest the 12 bit PWM can achieve.</li> <li>Human Speed - For a average human speed (3km/hr), the pwm was set for 2650.</li> <li>Erratic Speed - A set of 4 speed was created where the robot would cycle through them.</li> </ul> </li> </ul> </li> <li> <strong>Reactive Controller for Single Obstacle</strong> <ul> <li>The reactive controller is set up around the car being controlled with a twist. The actors in the scene for a single robot are the robot car and the wheelchair.</li> <li>For the proof of concept a simulation was created in simulation where the robot car was controlled using twist and the wheelchair would be non reactive. The two scenarios which I tested were a static wheelchair and a wheelchair that moves in a straight line.</li> <li>The robot is commanded a twist towards the goal location which is set, while on its way there if the robot comes in the wheelchair collision radius, it receives a twist tangential twist which makes it avoid the wheelchair until it gets out of the collision radius. Once the obstacle is avoided it follows a path towards the goal pose and stops there.</li> <li>Here are the two videos side by side</li> </ul> </li> </ol> <div class="row"> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/obs_avoidance_with_steady_obs.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" controls="" muted=""></video> </figure> </div> <div class="caption"> Static Wheelchair </div> </div> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/obs_avoidance_with_moving_wc.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" controls="" muted=""></video> </figure> </div> <div class="caption"> Moving Wheelchair </div> </div> </div> <ul> <li>After this proof of concept, I tested the code in real env. To do that, I used a global camera (realsense 455d) which can look at the entire map where the experiment was conducted. To get the locations of the objects in the frame apriltags were used. A world frame apriltag was set up as the connection between the camera and the floor. The other apriltags were considered in relation to the world apriltag on the floor.</li> <li>To test the robot car reactivity to the movements in apriltags, without setting it up on the wheelchair, kyle moved around the wc apriltag to see how the robot car would react and reach the goal.</li> <li>Some fails and examples are as below:</li> </ul> <div class="row"> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/kyle_good.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" controls="" muted=""></video> </figure> </div> <div class="caption"> Good Avoidance </div> </div> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/kyle_blooper.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" controls="" muted=""></video> </figure> </div> <div class="caption"> Blooper Avoidance </div> </div> </div> <ul> <li>After some iterations and getting the right movements and things, Here are the final videos of the car reacting to the wc movement. This video has changed hardware in terms of the car chassis but not for the electronics. The video test is now with a powered wheelchair and the car.</li> </ul> <div class="row center-content"> <div class="col"> <div class="col"> <figure> <video src="/assets/video/larrisa_good_test.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" controls="" muted=""></video> </figure> </div> <div class="caption text-center"> Obstacle avoidance with Wheelchair </div> </div> </div> <ul> <li>To get a better interaction an additional goal pose was added in front of the wheelchair, the controller was changed where the first task for the robot car is to reach in closer to the assigned pose, once it does that, it avoids the wheelchair and then follows a path towards the goal pose. This allows forces interaction with the wheelchair user and get better result.</li> <li>In the test below, the robot car will first path towards the wheelchair, avoid it and then path towards the goal pose.</li> </ul> <div class="row"> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/controlled_1.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" controls="" muted=""></video> </figure> </div> <div class="caption"> Test1 </div> </div> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/controlled_2.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" controls="" muted=""></video> </figure> </div> <div class="caption"> Test2 </div> </div> </div> <div class="row"> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/demiana_full_test_1.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" controls="" muted=""></video> </figure> </div> <div class="caption"> Test3 </div> </div> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/demiana_full_test_2.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" controls="" muted=""></video> </figure> </div> <div class="caption"> Test4 </div> </div> </div> <h5 id="acknowledgements"><strong>Acknowledgements</strong></h5> <ul> <li>Larisa Loke</li> <li>Joel Goh</li> <li>Kyle Puckett, Demiana Barsoum - For help with testings</li> <li>Dr. Brenna Argall</li> </ul> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Shail Dalal. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>